import{j as e,C,k as S,l as L,c as P,A as I,b as z,o as R,s as p,d as T,i as M,z as D,J as N,m as V,F as B,n as u,q as x,r as h,t as j,I as f,v as w,M as J,B as v,w as b,E,P as U,x as Z,L as q,y as G}from"./index-Dc-BS1W2.js";import{r as o}from"./emoji-mart-DRerY-OB.js";import{l as H,L as O}from"./Layout-TSHxcvNT.js";import{U as $}from"./user-DUzEMHwr.js";import"./badge-taJbTjbb.js";import"./popover-CGZmNc4e.js";import"./index-DrCm3EO8.js";import"./Combination-DuTqoeZY.js";import"./index-CE35kS-Q.js";import"./index-C_ZzNLza.js";import"./index-BkNWx6m2.js";import"./index-DE01g13U.js";import"./index--K3sZeIh.js";import"./index-FHuIi1st.js";import"./select-B3i9CjeT.js";import"./index-DqWbzM0E.js";import"./categoriesAPI-DvU_otkD.js";import"./pubLayoutAPI-DfYluJku.js";import"./arrow-up-BRrXiPPU.js";import"./database-BKbjrLJf.js";import"./circle-plus-gGTkOUJD.js";import"./clock-U9VSJiyP.js";import"./play-C68uu85c.js";import"./house-Qr62Kw0A.js";import"./shield-x-BsKCYJAg.js";import"./video-CY1c3mCS.js";import"./plus-DTTTuzsk.js";import"./search-DlKIh_Ll.js";import"./square-pen-D72gPhkm.js";import"./trash-2-DHce8VXy.js";import"./triangle-alert-Btc8UJ8c.js";import"./scroll-area-BfHT7kH_.js";import"./useMutation-CApHjpg4.js";const K=({children:a})=>{const[c,l]=o.useState(!0),[m,g]=o.useState(!0);o.useEffect(()=>{d()},[]);const d=async()=>{try{const r=await fetch("https://riziky-boutic-server.onrender.com/api/public-settings/general",{method:"GET",headers:{"Content-Type":"application/json"}});if(r.ok){const i=await r.json();console.log("Paramètres inscription récupérés:",i),l((i==null?void 0:i.allowRegistration)||!1)}else console.error("Erreur API paramètres inscription:",r.status),l(!0)}catch(r){console.error("Erreur lors de la vérification des inscriptions:",r),l(!0)}finally{g(!1)}};return m?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{children:"Chargement..."})}):c?e.jsx(e.Fragment,{children:a}):e.jsx("div",{className:"min-h-[70vh] flex items-center justify-center",children:e.jsxs(C,{className:"w-[400px]",children:[e.jsx(S,{children:e.jsx(L,{className:"text-center text-red-600",children:"Inscriptions Fermées"})}),e.jsx(P,{className:"text-center",children:e.jsx(I,{children:e.jsx(z,{children:"Les nouvelles inscriptions sont actuellement fermées. Veuillez contacter l'administrateur pour plus d'informations."})})})]})})},Q=R({nom:p().min(2,"Le nom doit contenir au moins 2 caractères"),email:p().email("Email invalide"),password:p().min(8,"Le mot de passe doit contenir au moins 8 caractères").regex(/[A-Z]/,"Le mot de passe doit contenir au moins une majuscule").regex(/[a-z]/,"Le mot de passe doit contenir au moins une minuscule").regex(/[0-9]/,"Le mot de passe doit contenir au moins un chiffre").regex(/[^A-Za-z0-9]/,"Le mot de passe doit contenir au moins un caractère spécial"),confirmPassword:p()}).refine(a=>a.password===a.confirmPassword,{message:"Les mots de passe ne correspondent pas",path:["confirmPassword"]}),Fe=()=>{const{register:a}=T(),[c,l]=o.useState(!1),[m,g]=o.useState(!1),[d,r]=o.useState(!1),[i,y]=o.useState(!1),t=M({resolver:G(Q),defaultValues:{nom:"",email:"",password:"",confirmPassword:""}}),F=H.debounce(async s=>{if(!(!s||!s.includes("@")))try{(await D.checkEmail(s)).data.exists?(r(!0),N.error("Cet email existe déjà")):r(!1)}catch(n){console.error("Erreur lors de la vérification de l'email:",n)}},500);o.useEffect(()=>{const s=t.watch((n,{name:A})=>{A==="email"&&F(n.email||"")});return()=>s.unsubscribe()},[t.watch]);const k=async s=>{if(d){N.error("Cet email existe déjà");return}try{y(!0),await a(s.nom,s.email,s.password)}catch(n){console.error("Erreur d'inscription:",n)}finally{y(!1)}};return e.jsx(O,{children:e.jsx(K,{children:e.jsx("div",{className:"flex justify-center items-center min-h-[70vh]",children:e.jsxs(C,{className:"w-[400px]",children:[e.jsxs(S,{children:[e.jsx(L,{children:"Inscription"}),e.jsx(V,{children:"Créez un nouveau compte"})]}),e.jsx(P,{children:e.jsx(B,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(k),className:"space-y-4",children:[e.jsx(u,{control:t.control,name:"nom",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Nom"}),e.jsx(j,{children:e.jsxs("div",{className:"relative",children:[e.jsx(f,{placeholder:"Votre nom",...s}),e.jsx($,{className:"absolute right-3 top-2.5 h-5 w-5 text-muted-foreground"})]})}),e.jsx(w,{})]})}),e.jsx(u,{control:t.control,name:"email",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Email"}),e.jsx(j,{children:e.jsxs("div",{className:"relative",children:[e.jsx(f,{placeholder:"email@example.com",...s}),e.jsx(J,{className:"absolute right-3 top-2.5 h-5 w-5 text-muted-foreground"})]})}),e.jsx(w,{})]})}),e.jsx(u,{control:t.control,name:"password",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Mot de passe"}),e.jsx(j,{children:e.jsxs("div",{className:"relative",children:[e.jsx(f,{type:c?"text":"password",placeholder:"********",...s}),e.jsx(v,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0",onClick:()=>l(!c),children:c?e.jsx(b,{className:"h-5 w-5 text-muted-foreground"}):e.jsx(E,{className:"h-5 w-5 text-muted-foreground"})})]})}),e.jsx(w,{}),e.jsx(U,{password:s.value})]})}),e.jsx(u,{control:t.control,name:"confirmPassword",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Confirmer le mot de passe"}),e.jsx(j,{children:e.jsxs("div",{className:"relative",children:[e.jsx(f,{type:m?"text":"password",placeholder:"********",...s}),e.jsx(v,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0",onClick:()=>g(!m),children:m?e.jsx(b,{className:"h-5 w-5 text-muted-foreground"}):e.jsx(E,{className:"h-5 w-5 text-muted-foreground"})})]})}),e.jsx(w,{})]})}),e.jsx(v,{type:"submit",className:"w-full",disabled:d||i,children:i?"Inscription en cours...":"S'inscrire"})]})})}),e.jsx(Z,{children:e.jsxs("div",{className:"text-sm text-muted-foreground w-full text-center",children:["Déjà un compte ?"," ",e.jsx(q,{to:"/login",className:"text-brand-blue hover:underline",children:"Se connecter"})]})})]})})})})};export{Fe as default};
