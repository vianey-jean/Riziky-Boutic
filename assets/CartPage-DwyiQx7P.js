import{K as b,j as e,$ as j,B as l,L as f,I as w,d as k,h as S}from"./index-Dc-BS1W2.js";import{r as N}from"./emoji-mart-DRerY-OB.js";import{L as g}from"./Layout-TSHxcvNT.js";import{L as I}from"./loading-spinner-jnMVzKdl.js";import{B as z}from"./badge-taJbTjbb.js";import{S as v}from"./index-DrCm3EO8.js";import{c as P,h as q}from"./pubLayoutAPI-DfYluJku.js";import{C as L}from"./checkbox-e3XHLN_v.js";import{P as E}from"./plus-DTTTuzsk.js";import{T as $}from"./trash-2-DHce8VXy.js";import"./popover-CGZmNc4e.js";import"./Combination-DuTqoeZY.js";import"./index-CE35kS-Q.js";import"./index-C_ZzNLza.js";import"./index-BkNWx6m2.js";import"./index-DE01g13U.js";import"./index--K3sZeIh.js";import"./user-DUzEMHwr.js";import"./index-FHuIi1st.js";import"./select-B3i9CjeT.js";import"./index-DqWbzM0E.js";import"./categoriesAPI-DvU_otkD.js";import"./search-DlKIh_Ll.js";import"./clock-U9VSJiyP.js";import"./database-BKbjrLJf.js";import"./scroll-area-BfHT7kH_.js";import"./useMutation-CApHjpg4.js";import"./arrow-up-BRrXiPPU.js";import"./circle-plus-gGTkOUJD.js";import"./play-C68uu85c.js";import"./house-Qr62Kw0A.js";import"./shield-x-BsKCYJAg.js";import"./video-CY1c3mCS.js";import"./square-pen-D72gPhkm.js";import"./triangle-alert-Btc8UJ8c.js";const A=({onCheckout:s,showCheckoutButton:h=!0,isCompact:m=!1,selectedItems:i={}})=>{const{cart:x}=b(),c=x?x.filter(d=>i[d.product.id]):[],o=c.reduce((d,p)=>d+p.product.price*p.quantity,0),r=c.reduce((d,p)=>d+p.quantity,0),u=c.length>0;return e.jsxs("div",{className:`bg-white ${m?"p-4":"p-6"} rounded-lg shadow`,children:[e.jsx("h2",{className:`${m?"text-lg":"text-xl"} font-semibold mb-4`,children:"Récapitulatif"}),u?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:[r," ",r>1?"articles":"article"," sélectionné",r>1?"s":""]}),e.jsx("span",{children:j(o)})]}),c.some(d=>d.product.promotion)&&e.jsxs("div",{className:"flex items-center py-1",children:[e.jsx(z,{variant:"destructive",className:"mr-2",children:"Promo"}),e.jsx("span",{className:"text-sm",children:"Prix promotionnels appliqués"})]}),e.jsxs("div",{className:"border-t pt-2 mt-2",children:[e.jsxs("div",{className:"flex justify-between font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:j(o)})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Frais de livraison calculés à l'étape suivante"})]})]}),h&&e.jsxs("div",{className:"mt-6",children:[e.jsxs(l,{className:"w-full",size:"lg",onClick:s,disabled:!u,children:[e.jsx(P,{className:"mr-2 h-4 w-4"})," Commander"]}),e.jsx("div",{className:"flex justify-center mt-3",children:e.jsx(f,{to:"/",className:"text-sm text-brand-blue hover:underline",children:"Continuer vos achats"})})]})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(v,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Aucun produit sélectionné"})]})]})},B=({item:s,isSelected:h,onSelectItem:m,onQuantityChange:i,onRemove:x})=>{const c="https://riziky-boutic-server.onrender.com";return e.jsxs("div",{className:"flex flex-col sm:flex-row border-b pb-5",children:[e.jsxs("div",{className:"flex items-center mb-4 sm:mb-0",children:[e.jsx(L,{checked:h,onCheckedChange:o=>m(s.product.id,o===!0),className:"mr-3",id:`select-${s.product.id}`}),e.jsx("div",{className:"sm:w-24 h-24",children:e.jsx("img",{src:`${c}/${s.product.image.startsWith("/")?s.product.image.slice(1):s.product.image}`,alt:s.product.name,className:"w-full h-full object-cover rounded-md",onError:o=>{const r=o.target;r.src=`${c}/uploads/placeholder.jpg`}})})]}),e.jsxs("div",{className:"flex-1 sm:ml-4 flex flex-col sm:flex-row justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium line-clamp-2",children:e.jsx(f,{to:`/produit/${s.product.id}`,className:"hover:text-brand-blue",children:s.product.name})}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-1 flex items-center",children:[e.jsxs("span",{children:[j(s.product.price)," par unité"]}),s.product.promotion&&e.jsxs("span",{className:"ml-2 text-red-600 text-xs bg-red-50 px-1.5 py-0.5 rounded",children:["-",s.product.promotion,"%"]})]}),s.product.stock!==void 0&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.product.stock>5?e.jsx("span",{className:"text-green-600",children:"En stock"}):s.product.stock>0?e.jsxs("span",{className:"text-amber-600",children:["Plus que ",s.product.stock," en stock"]}):e.jsx("span",{className:"text-red-600",children:"Rupture de stock"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4 sm:mt-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(l,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-r-none",onClick:()=>i(s.product.id,s.quantity-1),children:e.jsx(q,{className:"h-3 w-3"})}),e.jsx(w,{type:"text",value:s.quantity,onChange:o=>{const r=parseInt(o.target.value);isNaN(r)||i(s.product.id,r)},className:"h-8 w-12 rounded-none text-center p-0"}),e.jsx(l,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-l-none",onClick:()=>i(s.product.id,s.quantity+1),disabled:s.product.stock!==void 0&&s.quantity>=s.product.stock,children:e.jsx(E,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"flex items-center ml-6 sm:ml-12",children:[e.jsx("span",{className:"font-medium mr-4 whitespace-nowrap",children:j(s.product.price*s.quantity)}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>x(s.product.id),className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:e.jsx($,{className:"h-4 w-4"})})]})]})]})]})},R=({isAuthenticated:s})=>s?e.jsxs("div",{className:"text-center py-16 border rounded-lg bg-gray-50",children:[e.jsx("div",{className:"mb-4",children:e.jsx(v,{className:"h-16 w-16 mx-auto text-muted-foreground"})}),e.jsx("h2",{className:"text-2xl font-medium mb-3",children:"Votre panier est vide"}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-md mx-auto",children:"Ajoutez des produits à votre panier pour commencer votre commande"}),e.jsx(l,{asChild:!0,size:"lg",className:"bg-red-800 hover:bg-red-700",children:e.jsx(f,{to:"/",children:"Découvrir nos produits"})})]}):e.jsxs("div",{className:"text-center py-16 border rounded-lg bg-gray-50",children:[e.jsx("div",{className:"mb-4",children:e.jsx(v,{className:"h-16 w-16 mx-auto text-muted-foreground"})}),e.jsx("h2",{className:"text-2xl font-medium mb-3",children:"Connectez-vous pour voir votre panier"}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-md mx-auto",children:"Connectez-vous pour accéder à votre panier et profiter d'une expérience personnalisée"}),e.jsx(l,{asChild:!0,size:"lg",children:e.jsx(f,{to:"/login",children:"Se connecter"})})]}),ve=()=>{const{cart:s,updateQuantity:h,removeFromCart:m,loadingCart:i,setSelectedCartItems:x}=b(),{isAuthenticated:c}=k(),o=S(),[r,u]=N.useState({});N.useEffect(()=>{if(s&&s.length>0){const t=s.reduce((a,n)=>(a[n.product.id]=!0,a),{});u(t)}},[s]);const d=(t,a)=>{a>=1&&h(t,a)},p=(t,a)=>{u(n=>({...n,[t]:a}))},y=()=>{const t=s.filter(a=>r[a.product.id]);x(t),o("/paiement")};return i?e.jsx(g,{children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Votre Panier"}),e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(I,{text:"Chargement de votre panier..."})})]})}):e.jsx(g,{children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Votre Panier"}),!c||!s||s.length===0?e.jsx(R,{isAuthenticated:c}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Articles dans votre panier"}),e.jsx("div",{className:"space-y-5",children:s.map(t=>e.jsx(B,{item:t,isSelected:r[t.product.id]||!1,onSelectItem:p,onQuantityChange:d,onRemove:m},t.product.id))}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(l,{variant:"outline",className:"text-sm",onClick:()=>{const t=s.every(n=>r[n.product.id]),a=s.reduce((n,C)=>(n[C.product.id]=!t,n),{});u(a)},children:s.every(t=>r[t.product.id])?"Désélectionner tout":"Sélectionner tout"})})]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg text-sm text-muted-foreground",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"mr-3 mt-0.5",children:"ℹ️"}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-1",children:"Livraison offerte à partir de 50€ d'achat."}),e.jsx("p",{children:"Les frais de livraison sont calculés à l'étape suivante."})]})]})})]}),e.jsx("div",{className:"md:col-span-1",children:e.jsx(A,{onCheckout:y,selectedItems:r})})]})]})})};export{ve as default};
