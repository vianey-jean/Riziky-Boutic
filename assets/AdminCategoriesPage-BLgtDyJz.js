import{j as e,B as n,G as j,I as N,C as O,k as z,l as I,m as L,c as y,ay as t}from"./index-Dc-BS1W2.js";import{r as o}from"./emoji-mart-DRerY-OB.js";import{S as B}from"./switch-CHW0mfJ1.js";import{T as H}from"./textarea-C2Rhkt_I.js";import{B as P}from"./badge-taJbTjbb.js";import{D as q,a as M,b as G,d as R,c as U,e as J,f as K}from"./dialog-D1sIsNKu.js";import{A as Q,a as V,b as W,c as X,d as Y,e as Z,f as _,g as $,h as ee}from"./alert-dialog-BUmLs06s.js";import{T as re,a as se,b,c as d,d as ie,e as c}from"./table-D7tHapga.js";import{c as u}from"./categoriesAPI-DvU_otkD.js";import{A as w}from"./AdminLayout-CibHDjhS.js";import{P as ae}from"./plus-DTTTuzsk.js";import{A as te,a as le}from"./arrow-up-BRrXiPPU.js";import{S as ne}from"./square-pen-D72gPhkm.js";import{T as oe}from"./trash-2-DHce8VXy.js";import"./index-DrCm3EO8.js";import"./Combination-DuTqoeZY.js";import"./index-DqWbzM0E.js";import"./index-C_ZzNLza.js";import"./index-FHuIi1st.js";import"./index-DE01g13U.js";const ke=()=>{const[x,S]=o.useState([]),[E,f]=o.useState(!0),[T,g]=o.useState(!1),[h,v]=o.useState(null),[s,l]=o.useState({name:"",description:"",order:1,isActive:!0}),p=async()=>{try{f(!0);const r=await u.getAll();S(r.data||[])}catch(r){console.error("Erreur lors du chargement des catégories:",r),t({title:"Erreur",description:"Impossible de charger les catégories",variant:"destructive"})}finally{f(!1)}};o.useEffect(()=>{p()},[]);const A=r=>{if(r)v(r),l({name:r.name,description:r.description,order:r.order,isActive:r.isActive});else{v(null);const i=Math.max(...x.map(a=>a.order),0);l({name:"",description:"",order:i+1,isActive:!0})}g(!0)},C=()=>{g(!1),v(null),l({name:"",description:"",order:1,isActive:!0})},k=async r=>{var i,a;if(r.preventDefault(),!s.name.trim()){t({title:"Erreur",description:"Le nom de la catégorie est requis",variant:"destructive"});return}try{h?(await u.update(h.id,s),t({title:"Succès",description:"Catégorie mise à jour avec succès"})):(await u.create(s),t({title:"Succès",description:"Catégorie créée avec succès"})),C(),p()}catch(m){console.error("Erreur lors de la sauvegarde:",m),t({title:"Erreur",description:((a=(i=m.response)==null?void 0:i.data)==null?void 0:a.error)||"Erreur lors de la sauvegarde",variant:"destructive"})}},F=async r=>{var i,a;try{await u.delete(r),t({title:"Succès",description:"Catégorie supprimée avec succès"}),p()}catch(m){console.error("Erreur lors de la suppression:",m),t({title:"Erreur",description:((a=(i=m.response)==null?void 0:i.data)==null?void 0:a.error)||"Erreur lors de la suppression",variant:"destructive"})}},D=async(r,i)=>{try{await u.update(r,{order:i}),p()}catch(a){console.error("Erreur lors du changement d'ordre:",a),t({title:"Erreur",description:"Erreur lors du changement d'ordre",variant:"destructive"})}};return E?e.jsx(w,{children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})}):e.jsx(w,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Gestion des Catégories"}),e.jsx("p",{className:"text-gray-600",children:"Gérez les catégories de produits du site"})]}),e.jsxs(q,{open:T,onOpenChange:g,children:[e.jsx(M,{asChild:!0,children:e.jsxs(n,{onClick:()=>A(),className:"bg-red-600 hover:bg-red-700",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Ajouter une catégorie"]})}),e.jsx(G,{className:"sm:max-w-[425px]",children:e.jsxs("form",{onSubmit:k,children:[e.jsxs(R,{children:[e.jsx(U,{children:h?"Modifier la catégorie":"Ajouter une catégorie"}),e.jsx(J,{children:h?"Modifiez les informations de la catégorie":"Ajoutez une nouvelle catégorie de produits"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"name",children:"Nom *"}),e.jsx(N,{id:"name",value:s.name,onChange:r=>l({...s,name:r.target.value}),placeholder:"Ex: perruques",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"description",children:"Description"}),e.jsx(H,{id:"description",value:s.description,onChange:r=>l({...s,description:r.target.value}),placeholder:"Description de la catégorie"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"order",children:"Ordre d'affichage"}),e.jsx(N,{id:"order",type:"number",min:"1",value:s.order,onChange:r=>l({...s,order:parseInt(r.target.value)||1})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{id:"isActive",checked:s.isActive,onCheckedChange:r=>l({...s,isActive:r})}),e.jsx(j,{htmlFor:"isActive",children:"Catégorie active"})]})]}),e.jsxs(K,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:C,children:"Annuler"}),e.jsx(n,{type:"submit",className:"bg-red-600 hover:bg-red-700",children:h?"Modifier":"Ajouter"})]})]})})]})]}),e.jsxs(O,{children:[e.jsxs(z,{children:[e.jsx(I,{children:"Liste des catégories"}),e.jsxs(L,{children:[x.length," catégorie(s) au total"]})]}),e.jsx(y,{children:e.jsxs(re,{children:[e.jsx(se,{children:e.jsxs(b,{children:[e.jsx(d,{children:"Ordre"}),e.jsx(d,{children:"Nom"}),e.jsx(d,{children:"Description"}),e.jsx(d,{children:"Statut"}),e.jsx(d,{children:"Date de création"}),e.jsx(d,{className:"text-right",children:"Actions"})]})}),e.jsx(ie,{children:x.map(r=>e.jsxs(b,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:r.order}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(n,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>D(r.id,r.order-1),disabled:r.order<=1,children:e.jsx(te,{className:"h-3 w-3"})}),e.jsx(n,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>D(r.id,r.order+1),disabled:r.order>=x.length,children:e.jsx(le,{className:"h-3 w-3"})})]})]})}),e.jsx(c,{className:"font-medium",children:r.name}),e.jsx(c,{children:r.description}),e.jsx(c,{children:e.jsx(P,{variant:r.isActive?"default":"secondary",children:r.isActive?"Active":"Inactive"})}),e.jsx(c,{children:new Date(r.createdAt).toLocaleDateString("fr-FR")}),e.jsx(c,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>A(r),children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsxs(Q,{children:[e.jsx(V,{asChild:!0,children:e.jsx(n,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-800",children:e.jsx(oe,{className:"h-4 w-4"})})}),e.jsxs(W,{children:[e.jsxs(X,{children:[e.jsx(Y,{children:"Supprimer la catégorie"}),e.jsxs(Z,{children:['Êtes-vous sûr de vouloir supprimer la catégorie "',r.name,'" ? Cette action est irréversible.']})]}),e.jsxs(_,{children:[e.jsx($,{children:"Annuler"}),e.jsx(ee,{onClick:()=>F(r.id),className:"bg-red-600 hover:bg-red-700",children:"Supprimer"})]})]})]})]})})]},r.id))})]})})]})]})})};export{ke as default};
