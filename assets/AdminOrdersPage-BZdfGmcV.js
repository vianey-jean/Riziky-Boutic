import{_ as f,j as s,C as g,k as v,l as N,c as y,U as b,a1 as n,J as i}from"./index-Dc-BS1W2.js";import{S as w,a as C,b as A,c as S,d as t}from"./select-B3i9CjeT.js";import{a as E,u as k}from"./useMutation-CApHjpg4.js";import{A as q}from"./AdminLayout-CibHDjhS.js";import{S as c,b as M,T}from"./index-DrCm3EO8.js";import{f as U}from"./format-BqfI4fP3.js";import{f as F}from"./fr-Bao31GFJ.js";import"./emoji-mart-DRerY-OB.js";import"./index-BkNWx6m2.js";import"./index-CE35kS-Q.js";import"./index-C_ZzNLza.js";import"./Combination-DuTqoeZY.js";import"./index-DqWbzM0E.js";const z=()=>{const m=f(),r="https://riziky-boutic-server.onrender.com",{data:l=[],isLoading:d}=E({queryKey:["admin-orders"],queryFn:async()=>(await n.getAll()).data}),o=k({mutationFn:async({orderId:e,status:a})=>{await n.updateStatus(e,a)},onSuccess:()=>{m.invalidateQueries({queryKey:["admin-orders"]}),i.success("Statut de la commande mis à jour")},onError:()=>{i.error("Erreur lors de la mise à jour du statut")}}),x=(e,a)=>{o.mutate({orderId:e,status:a})},u=e=>U(new Date(e),"dd MMMM yyyy",{locale:F}),h=e=>e?e.startsWith("http")?e:`${r}${e}`:"";return d?s.jsx("div",{className:"flex justify-center items-center h-screen",children:"Chargement des commandes..."}):s.jsx(q,{children:s.jsxs("div",{className:"p-6",children:[s.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Gestion des Commandes"}),l.length===0?s.jsx("div",{className:"text-center py-10 border rounded-md",children:s.jsx("p",{children:"Aucune commande trouvée."})}):s.jsx("div",{className:"grid gap-6",children:l.map(e=>s.jsxs(g,{children:[s.jsx(v,{className:"pb-2",children:s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[s.jsxs("div",{children:[s.jsxs(N,{children:["Commande #",e.id.split("-")[1]]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[u(e.createdAt)," par ",e.userName," (",e.userEmail,")"]})]}),s.jsx("div",{className:"mt-2 sm:mt-0",children:s.jsxs("p",{className:"font-bold",children:[e.totalAmount.toFixed(2)," €"]})})]})}),s.jsxs(y,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-sm font-medium mb-2",children:"Produits:"}),s.jsx("div",{className:"flex flex-col gap-2",children:e.items.map(a=>s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded overflow-hidden mr-2",children:a.image?s.jsx("img",{src:h(a.image),alt:a.name,className:"w-full h-full object-cover",onError:p=>{const j=p.target;j.src=`${r}/uploads/placeholder.jpg`}}):s.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:s.jsx(c,{className:"h-4 w-4 text-gray-500"})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium",children:a.name}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.quantity," × ",a.price.toFixed(2)," €"]})]})]},a.productId))})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h3",{className:"text-sm font-medium mb-2",children:"Adresse de livraison:"}),s.jsxs("p",{className:"text-sm",children:[e.shippingAddress.prenom," ",e.shippingAddress.nom,", ",e.shippingAddress.adresse,",",e.shippingAddress.codePostal," ",e.shippingAddress.ville,", ",e.shippingAddress.pays]})]}),s.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row items-start sm:items-center justify-between",children:[s.jsxs("div",{className:"flex space-x-2 mb-2 sm:mb-0",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${e.status==="confirmée"?"bg-blue-500":e.status==="en préparation"?"bg-yellow-500":e.status==="en livraison"?"bg-orange-500":"bg-green-500"}`}),s.jsxs("span",{className:"text-sm",children:["Statut actuel: ",e.status.charAt(0).toUpperCase()+e.status.slice(1)]})]}),s.jsxs(w,{defaultValue:e.status,onValueChange:a=>x(e.id,a),children:[s.jsx(C,{className:"w-[180px]",children:s.jsx(A,{placeholder:"Changer le statut"})}),s.jsxs(S,{children:[s.jsx(t,{value:"confirmée",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(b,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Confirmée"})]})}),s.jsx(t,{value:"en préparation",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(M,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"En préparation"})]})}),s.jsx(t,{value:"en livraison",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(T,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"En livraison"})]})}),s.jsx(t,{value:"livrée",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(c,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Livrée"})]})})]})]})]})]})]},e.id))})]})})};export{z as default};
