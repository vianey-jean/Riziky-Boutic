import{j as e,G as y,I as D,B as E,J as P,V as ae,W as U,Y as te,K as Ie,d as Ee,h as Le,L as ke,$ as F}from"./index-Dc-BS1W2.js";import{r as o}from"./emoji-mart-DRerY-OB.js";import{v as Fe,p as Ve,q as Ae,r as qe,L as Y}from"./Layout-TSHxcvNT.js";import{S as Z,a as ee,b as re,c as se,d as q}from"./select-B3i9CjeT.js";import{L as oe}from"./loading-spinner-jnMVzKdl.js";import{c as Ge}from"./codePromosAPI-CIelwPMP.js";import{c as ie,a as K,P as $e}from"./index-DrCm3EO8.js";import{c as ne,R as _e,I as Te}from"./index--K3sZeIh.js";import{u as ze}from"./Combination-DuTqoeZY.js";import{u as Me}from"./index-BkNWx6m2.js";import{u as Oe}from"./index-C_ZzNLza.js";import{u as Be}from"./index-DqWbzM0E.js";import{P as Ye}from"./index-DE01g13U.js";import{b as Ke}from"./user-DUzEMHwr.js";import{C as Ue}from"./database-BKbjrLJf.js";import{B as Je,S as He}from"./pubLayoutAPI-DfYluJku.js";import"./badge-taJbTjbb.js";import"./popover-CGZmNc4e.js";import"./index-CE35kS-Q.js";import"./index-FHuIi1st.js";import"./categoriesAPI-DvU_otkD.js";import"./search-DlKIh_Ll.js";import"./clock-U9VSJiyP.js";import"./scroll-area-BfHT7kH_.js";import"./useMutation-CApHjpg4.js";import"./arrow-up-BRrXiPPU.js";import"./circle-plus-gGTkOUJD.js";import"./play-C68uu85c.js";import"./house-Qr62Kw0A.js";import"./shield-x-BsKCYJAg.js";import"./video-CY1c3mCS.js";import"./plus-DTTTuzsk.js";import"./square-pen-D72gPhkm.js";import"./trash-2-DHce8VXy.js";import"./triangle-alert-Btc8UJ8c.js";const We=({onSuccess:a})=>{const[p,n]=o.useState(""),[s,c]=o.useState(""),[d,u]=o.useState(""),[h,g]=o.useState(""),[N,S]=o.useState(!1),[i,v]=o.useState({cardNumber:"",cardName:"",expiryDate:"",cvv:""}),x=t=>t.replace(/\D/g,"").slice(0,16).replace(/(\d{4})(?=\d)/g,"$1 "),C=t=>{const b=t.replace(/\D/g,"").slice(0,4);return b.length>2?`${b.slice(0,2)}/${b.slice(2)}`:b},f=t=>{n(x(t.target.value)),v(l=>({...l,cardNumber:""}))},w=t=>{u(C(t.target.value)),v(l=>({...l,expiryDate:""}))},L=t=>{c(t.target.value),v(l=>({...l,cardName:""}))},z=t=>{const l=t.target.value.replace(/\D/g,"").slice(0,3);g(l),v(b=>({...b,cvv:""}))},V=t=>{const l=t.replace(/\s/g,"");return l.length!==16?!1:/^\d{16}$/.test(l)},$=t=>{if(t.length!==5)return!1;const l=t.split("/");if(l.length!==2)return!1;const b=parseInt(l[0],10),k=parseInt("20"+l[1],10);if(isNaN(b)||isNaN(k)||b<1||b>12)return!1;const I=new Date,_=I.getFullYear(),M=I.getMonth()+1;return!(k<_||k===_&&b<M)},m=()=>{let t=!0;const l={cardNumber:"",cardName:"",expiryDate:"",cvv:""};return s.trim()||(l.cardName="Le nom du titulaire est requis",t=!1),V(p)||(l.cardNumber="Numéro de carte invalide",t=!1),$(d)||(l.expiryDate="Date d'expiration invalide",t=!1),h.length<3&&(l.cvv="CVV invalide",t=!1),v(l),t},A=t=>{t.preventDefault(),m()&&(S(!0),setTimeout(()=>{S(!1),P.success("Paiement accepté"),a&&typeof a=="function"?(console.log("Calling onSuccess after payment"),a()):console.error("onSuccess callback is not properly defined")},1500))};return e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"cardName",children:"Titulaire de la carte"}),e.jsx(D,{id:"cardName",placeholder:"John Doe",value:s,onChange:L,required:!0,className:i.cardName?"border-red-500":""}),i.cardName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.cardName})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"cardNumber",children:"Numéro de carte"}),e.jsx(D,{id:"cardNumber",placeholder:"1234 5678 9012 3456",value:p,onChange:f,required:!0,className:i.cardNumber?"border-red-500":""}),i.cardNumber&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.cardNumber})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx(y,{htmlFor:"expiryDate",children:"Date d'expiration"}),e.jsx(D,{id:"expiryDate",placeholder:"MM/YY",value:d,onChange:w,required:!0,className:i.expiryDate?"border-red-500":""}),i.expiryDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.expiryDate})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx(y,{htmlFor:"cvv",children:"CVV"}),e.jsx(D,{id:"cvv",placeholder:"123",value:h,onChange:z,required:!0,type:"password",className:i.cvv?"border-red-500":""}),i.cvv&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.cvv})]})]}),e.jsx(E,{type:"submit",className:"w-full mt-4 bg-red-800 hover:bg-red-700",disabled:N,children:N?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx(oe,{size:"sm",className:"mr-2"})," Traitement en cours..."]}):"Payer"})]})};var J="Radio",[Xe,le]=ie(J),[Qe,Ze]=Xe(J),ce=o.forwardRef((a,p)=>{const{__scopeRadio:n,name:s,checked:c=!1,required:d,disabled:u,value:h="on",onCheck:g,form:N,...S}=a,[i,v]=o.useState(null),x=ae(p,w=>v(w)),C=o.useRef(!1),f=i?N||!!i.closest("form"):!0;return e.jsxs(Qe,{scope:n,checked:c,disabled:u,children:[e.jsx(U.button,{type:"button",role:"radio","aria-checked":c,"data-state":pe(c),"data-disabled":u?"":void 0,disabled:u,value:h,...S,ref:x,onClick:K(a.onClick,w=>{c||g==null||g(),f&&(C.current=w.isPropagationStopped(),C.current||w.stopPropagation())})}),f&&e.jsx(er,{control:i,bubbles:!C.current,name:s,value:h,checked:c,required:d,disabled:u,form:N,style:{transform:"translateX(-100%)"}})]})});ce.displayName=J;var de="RadioIndicator",me=o.forwardRef((a,p)=>{const{__scopeRadio:n,forceMount:s,...c}=a,d=Ze(de,n);return e.jsx(Ye,{present:s||d.checked,children:e.jsx(U.span,{"data-state":pe(d.checked),"data-disabled":d.disabled?"":void 0,...c,ref:p})})});me.displayName=de;var er=a=>{const{control:p,checked:n,bubbles:s=!0,...c}=a,d=o.useRef(null),u=Be(n),h=Oe(p);return o.useEffect(()=>{const g=d.current,N=window.HTMLInputElement.prototype,i=Object.getOwnPropertyDescriptor(N,"checked").set;if(u!==n&&i){const v=new Event("click",{bubbles:s});i.call(g,n),g.dispatchEvent(v)}},[u,n,s]),e.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:n,...c,tabIndex:-1,ref:d,style:{...a.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function pe(a){return a?"checked":"unchecked"}var rr=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],H="RadioGroup",[sr,Or]=ie(H,[ne,le]),ue=ne(),xe=le(),[ar,tr]=sr(H),he=o.forwardRef((a,p)=>{const{__scopeRadioGroup:n,name:s,defaultValue:c,value:d,required:u=!1,disabled:h=!1,orientation:g,dir:N,loop:S=!0,onValueChange:i,...v}=a,x=ue(n),C=Me(N),[f,w]=ze({prop:d,defaultProp:c,onChange:i});return e.jsx(ar,{scope:n,name:s,required:u,disabled:h,value:f,onValueChange:w,children:e.jsx(_e,{asChild:!0,...x,orientation:g,dir:C,loop:S,children:e.jsx(U.div,{role:"radiogroup","aria-required":u,"aria-orientation":g,"data-disabled":h?"":void 0,dir:C,...v,ref:p})})})});he.displayName=H;var ve="RadioGroupItem",fe=o.forwardRef((a,p)=>{const{__scopeRadioGroup:n,disabled:s,...c}=a,d=tr(ve,n),u=d.disabled||s,h=ue(n),g=xe(n),N=o.useRef(null),S=ae(p,N),i=d.value===c.value,v=o.useRef(!1);return o.useEffect(()=>{const x=f=>{rr.includes(f.key)&&(v.current=!0)},C=()=>v.current=!1;return document.addEventListener("keydown",x),document.addEventListener("keyup",C),()=>{document.removeEventListener("keydown",x),document.removeEventListener("keyup",C)}},[]),e.jsx(Te,{asChild:!0,...h,focusable:!u,active:i,children:e.jsx(ce,{disabled:u,required:d.required,checked:i,...g,...c,name:d.name,ref:S,onCheck:()=>d.onValueChange(c.value),onKeyDown:K(x=>{x.key==="Enter"&&x.preventDefault()}),onFocus:K(c.onFocus,()=>{var x;v.current&&((x=N.current)==null||x.click())})})})});fe.displayName=ve;var or="RadioGroupIndicator",je=o.forwardRef((a,p)=>{const{__scopeRadioGroup:n,...s}=a,c=xe(n);return e.jsx(me,{...c,...s,ref:p})});je.displayName=or;var ge=he,ye=fe,ir=je;const Ne=o.forwardRef(({className:a,...p},n)=>e.jsx(ge,{className:te("grid gap-2",a),...p,ref:n}));Ne.displayName=ge.displayName;const G=o.forwardRef(({className:a,...p},n)=>e.jsx(ye,{ref:n,className:te("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...p,children:e.jsx(ir,{className:"flex items-center justify-center",children:e.jsx(Ke,{className:"h-2.5 w-2.5 fill-current text-current"})})}));G.displayName=ye.displayName;const nr=({selectedMethod:a,onMethodChange:p,isDisabled:n=!1})=>e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Mode de paiement"}),e.jsx(Ne,{value:a,onValueChange:p,disabled:n,children:e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:`flex items-center space-x-2 rounded-md border p-3 ${a==="card"?"border-primary bg-primary/5":""}`,children:[e.jsx(G,{value:"card",id:"card"}),e.jsxs(y,{htmlFor:"card",className:"flex-grow cursor-pointer flex items-center",children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Carte bancaire"})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("img",{src:Fe,alt:"Visa",className:"h-6"}),e.jsx("img",{src:Ve,alt:"Mastercard",className:"h-6"})]})]}),e.jsxs("div",{className:`flex items-center space-x-2 rounded-md border p-3 ${a==="paypal"?"border-primary bg-primary/5":""}`,children:[e.jsx(G,{value:"paypal",id:"paypal"}),e.jsx(y,{htmlFor:"paypal",className:"flex-grow cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:Ae,alt:"PayPal",className:"h-5 mr-2"}),e.jsx("span",{children:"PayPal"})]})})]}),e.jsxs("div",{className:`flex items-center space-x-2 rounded-md border p-3 ${a==="applepay"?"border-primary bg-primary/5":""}`,children:[e.jsx(G,{value:"applepay",id:"applepay"}),e.jsx(y,{htmlFor:"applepay",className:"flex-grow cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:qe,alt:"Apple Pay",className:"h-5 mr-2"}),e.jsx("span",{children:"Apple Pay"})]})})]}),e.jsxs("div",{className:`flex items-center space-x-2 rounded-md border p-3 ${a==="cash"?"border-primary bg-primary/5":""}`,children:[e.jsx(G,{value:"cash",id:"cash"}),e.jsxs(y,{htmlFor:"cash",className:"flex-grow cursor-pointer flex items-center",children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Paiement à la livraison"})]})]})]})}),a==="card"&&e.jsx("div",{className:"mt-4 text-sm text-muted-foreground",children:e.jsx("p",{children:"Vous serez redirigé vers notre page de paiement sécurisé"})}),a==="paypal"&&e.jsx("div",{className:"mt-4 text-sm text-muted-foreground",children:e.jsx("p",{children:"Vous serez redirigé vers PayPal pour finaliser votre paiement"})}),a==="applepay"&&e.jsx("div",{className:"mt-4 text-sm text-muted-foreground",children:e.jsx("p",{children:"Paiement sécurisé avec Apple Pay"})}),a==="cash"&&e.jsx("div",{className:"mt-4 text-sm text-muted-foreground",children:e.jsx("p",{children:"Vous paierez à la livraison. Préparez le montant exact si possible."})})]}),T={"Saint-Benoît":20,"Saint-Denis":0,"Saint-Pierre":20,"Bras-Panon":25,"Entre-Deux":20,"Etang-Salé":25,"Petite-Île":20,"Le Port":0,"La Possession":0,"Saint-André":10,"Saint Joseph":25,"Saint-Leu":15,"Saint-Louis":15,"Saint-Paul":0,"Saint-Philippe":25,"Sainte-Marie":0,"Sainte-Rose":25,"Sainte-Suzanne":0,Salazie:25,Tampon:20,"Trois-Bassins":20},Br=()=>{const{selectedCartItems:a,getCartTotal:p,createOrder:n}=Ie(),{user:s}=Ee(),c=Le(),[d,u]=o.useState(!1),[h,g]=o.useState("card"),[N,S]=o.useState(!1),[i,v]=o.useState(""),[x,C]=o.useState(0),[f,w]=o.useState("shipping"),[L,z]=o.useState(""),[V,$]=o.useState(!1),[m,A]=o.useState(null),[t,l]=o.useState({nom:(s==null?void 0:s.nom)||"",prenom:(s==null?void 0:s.prenom)||"",adresse:(s==null?void 0:s.adresse)||"",ville:(s==null?void 0:s.ville)||"",codePostal:(s==null?void 0:s.codePostal)||"",pays:(s==null?void 0:s.pays)||"La Réunion",telephone:(s==null?void 0:s.telephone)||""}),b=a.every(r=>r.product.promotion&&r.product.promotion>0),k=a.some(r=>!r.product.promotion||r.product.promotion<=0);o.useEffect(()=>{a.length===0&&(P.error("Votre panier est vide. Veuillez ajouter des produits avant de procéder au paiement."),c("/panier"))},[a,c]),o.useEffect(()=>{s&&l({nom:s.nom||"",prenom:s.prenom||"",adresse:s.adresse||"",ville:s.ville||"",codePostal:s.codePostal||"",pays:s.pays||"La Réunion",telephone:s.telephone||""})},[s]);const I=r=>{const{name:j,value:R}=r.target;l(De=>({...De,[j]:R}))},_=r=>{v(r),l(R=>({...R,ville:r}));const j=T[r]||0;C(j)},M=async()=>{if(!L.trim()){P.error("Veuillez saisir un code promo");return}const r=a.find(j=>!j.product.promotion||j.product.promotion<=0);if(!r){P.error("Aucun produit éligible pour un code promo");return}$(!0);try{const R=(await Ge.verify(L,r.product.id)).data;R.valid&&R.pourcentage?(A({valid:!0,pourcentage:R.pourcentage,productId:r.product.id,code:L}),P.success(`Code promo valide ! ${R.pourcentage}% de réduction appliquée`)):(A(null),P.error(R.message||"Code promo invalide"))}catch(j){console.error("Erreur lors de la vérification du code promo:",j),A(null),P.error("Erreur lors de la vérification du code promo")}finally{$(!1)}},be=r=>{if(r.preventDefault(),!Se()){P.error("Veuillez remplir tous les champs obligatoires");return}if(!i){P.error("Veuillez sélectionner une ville de livraison");return}w("payment"),window.scrollTo(0,0)},Ce=r=>{r.preventDefault(),h==="card"?S(!0):W()},W=async()=>{u(!0);try{if(console.log("Traitement de commande avec données:",{shippingAddress:t,paymentMethod:h,cartItems:a.map(j=>({productId:j.product.id,quantity:j.quantity})),promoDetails:m?{code:m.code,productId:m.productId,pourcentage:m.pourcentage}:void 0}),a.length===0){P.error("Votre panier est vide. Impossible de créer la commande."),u(!1);return}await n(t,h,m?{code:m.code,productId:m.productId,pourcentage:m.pourcentage}:void 0)?(P.success("Commande effectuée avec succès !"),c("/commandes")):P.error("Erreur lors de la création de la commande")}catch(r){console.error("Erreur:",r),P.error("Une erreur est survenue lors de la validation de la commande")}finally{u(!1)}},Pe=()=>{console.log("Payment success, processing order..."),W()},Se=()=>t.nom.trim()!==""&&t.prenom.trim()!==""&&t.adresse.trim()!==""&&i!==""&&t.codePostal.trim()!==""&&t.pays.trim()!==""&&t.telephone.trim()!=="",X=r=>m&&m.valid&&r.product.id===m.productId?r.product.price*(1-m.pourcentage/100)*r.quantity:r.product.price*r.quantity,O=p(),B=a.reduce((r,j)=>r+X(j),0),we=O!==B,Re=B+x,Q="https://riziky-boutic-server.onrender.com";return a.length===0?e.jsx(Y,{children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(He,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Votre panier est vide"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Ajoutez des produits à votre panier pour commander"}),e.jsx(E,{asChild:!0,children:e.jsx(ke,{to:"/panier",children:"Retour au panier"})})]})})}):d?e.jsx(Y,{children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-12",children:e.jsx("div",{className:"flex flex-col items-center justify-center min-h-[400px]",children:e.jsx(oe,{size:"lg",text:"Traitement de votre commande..."})})})}):e.jsx(Y,{children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center",children:"Finaliser la commande"}),e.jsx("div",{className:"mb-12",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:`flex-1 text-center ${f==="shipping"?"font-semibold":""}`,children:[e.jsx("div",{className:`w-8 h-8 mx-auto mb-2 rounded-full flex items-center justify-center ${f==="shipping"?"bg-primary text-white":"bg-gray-200"}`,children:"1"}),e.jsx("span",{className:"text-sm",children:"Livraison"})]}),e.jsx("div",{className:"w-1/4 h-1 bg-gray-200",children:e.jsx("div",{className:`h-full bg-primary ${f==="payment"?"w-full":"w-0"} transition-all duration-500`})}),e.jsxs("div",{className:`flex-1 text-center ${f==="payment"?"font-semibold":""}`,children:[e.jsx("div",{className:`w-8 h-8 mx-auto mb-2 rounded-full flex items-center justify-center ${f==="payment"?"bg-primary text-white":"bg-gray-200"}`,children:"2"}),e.jsx("span",{className:"text-sm",children:"Paiement"})]})]})}),N?e.jsxs("div",{className:"max-w-md mx-auto bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Paiement par carte bancaire"}),e.jsx(We,{onSuccess:Pe}),e.jsx(E,{variant:"outline",className:"mt-4 w-full",onClick:()=>S(!1),children:"Retour"})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[f==="shipping"&&e.jsxs("form",{onSubmit:be,children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Informations de livraison"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"nom",children:"Nom*"}),e.jsx(D,{id:"nom",name:"nom",value:t.nom,onChange:I,required:!0})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"prenom",children:"Prénom*"}),e.jsx(D,{id:"prenom",name:"prenom",value:t.prenom,onChange:I,required:!0})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(y,{htmlFor:"adresse",children:"Adresse*"}),e.jsx(D,{id:"adresse",name:"adresse",value:t.adresse,onChange:I,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"ville",children:"Ville de livraison*"}),e.jsxs(Z,{value:i,onValueChange:_,children:[e.jsx(ee,{id:"ville",children:e.jsx(re,{placeholder:"Sélectionnez une ville"})}),e.jsx(se,{children:Object.keys(T).sort().map(r=>e.jsxs(q,{value:r,children:[r," ",T[r]===0?"(Gratuit)":`(+${T[r]}€)`]},r))})]})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"codePostal",children:"Code postal*"}),e.jsx(D,{id:"codePostal",name:"codePostal",value:t.codePostal,onChange:I,required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"pays",children:"Pays*"}),e.jsxs(Z,{value:t.pays,onValueChange:r=>l({...t,pays:r}),children:[e.jsx(ee,{id:"pays",children:e.jsx(re,{placeholder:"Sélectionnez un pays"})}),e.jsxs(se,{children:[e.jsx(q,{value:"La Réunion",children:"La Réunion"}),e.jsx(q,{value:"France",children:"France"}),e.jsx(q,{value:"Madagascar",children:"Madagascar"}),e.jsx(q,{value:"Mayotte",children:"Mayotte"})]})]})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"telephone",children:"Téléphone*"}),e.jsx(D,{id:"telephone",name:"telephone",type:"tel",value:t.telephone,onChange:I,required:!0})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsx(E,{type:"button",variant:"outline",onClick:()=>c("/panier"),children:"Retour au panier"}),e.jsx(E,{type:"submit",className:"bg-red-800 hover:bg-red-700",children:"Continuer au paiement"})]})]}),f==="payment"&&e.jsxs("form",{onSubmit:Ce,children:[e.jsx(nr,{selectedMethod:h,onMethodChange:g}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsx(E,{type:"button",variant:"outline",onClick:()=>w("shipping"),children:"Retour"}),e.jsx(E,{type:"submit",className:"bg-red-800 hover:bg-red-700",disabled:d,children:d?"Traitement en cours...":"Confirmer la commande"})]})]})]}),e.jsxs("div",{className:"lg:col-span-4",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Récapitulatif de commande"}),e.jsx("div",{className:"space-y-4 mb-6",children:a.map(r=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:`${Q}${r.product.images&&r.product.images.length>0?r.product.images[0]:r.product.image}`,alt:r.product.name,className:"w-16 h-16 object-cover rounded",onError:j=>{const R=j.target;R.src=`${Q}/uploads/placeholder.jpg`}}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("p",{className:"font-medium line-clamp-2 text-sm",children:r.product.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.quantity," x ",F(r.product.price),m&&m.valid&&r.product.id===m.productId&&e.jsxs("span",{className:"ml-2 text-red-600",children:["(-",m.pourcentage,"%)"]}),r.product.promotion&&r.product.promotion>0&&e.jsxs("span",{className:"ml-2 text-green-600",children:["(Déjà en promo: -",r.product.promotion,"%)"]})]})]}),e.jsx("p",{className:"font-semibold text-sm whitespace-nowrap",children:F(X(r))})]},r.product.id))}),e.jsxs("div",{className:"border-t pt-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{children:"Sous-total"}),e.jsx("p",{children:F(O)})]}),we&&e.jsxs("div",{className:"flex justify-between text-red-600",children:[e.jsx("p",{children:"Remise code promo"}),e.jsxs("p",{children:["-",F(O-B)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("p",{children:["Frais de livraison (",i||"Non sélectionné",")"]}),e.jsx("p",{children:x===0&&!i?"Non calculé":x===0?"Gratuit":F(x)})]}),f==="shipping"&&!b&&k&&e.jsxs("div",{className:"py-3 border-t border-b",children:[e.jsx("p",{className:"font-medium mb-2",children:"Code Promotion"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(D,{placeholder:"Saisir votre code promo",value:L,onChange:r=>z(r.target.value),disabled:m!==null||V}),e.jsx(E,{onClick:M,disabled:!L||m!==null||V,variant:"outline",children:V?"Vérification...":"Appliquer"})]}),m&&m.valid&&e.jsxs("div",{className:"mt-2 flex items-center text-sm text-green-600",children:[e.jsx($e,{className:"h-4 w-4 mr-1"}),"Code promo appliqué : ",m.pourcentage,"% de réduction"]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg pt-2",children:[e.jsx("p",{children:"Total"}),e.jsx("p",{children:F(Re)})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Informations sur la livraison"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"• Livraison gratuite à partir de 50€ d'achat"}),e.jsx("li",{children:"• Les frais de livraison varient selon la ville"}),e.jsx("li",{children:"• Livraison en 3-5 jours ouvrés"}),e.jsx("li",{children:"• Retours gratuits sous 30 jours"}),e.jsx("li",{children:"• Paiements sécurisés"})]})]})]})]})]})})};export{Br as default};
